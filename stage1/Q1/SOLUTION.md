### vqe_01

题目：给定一些原子，求所组成分子基态能量最低时的空间结构，即给出每个原子的坐标；要求用 QuPack 实现

目标：优化得到分子结构的真实理论 FCI 越低越好 (以 pyscf 为度量)

基本思路：寻找给定函数的最小值点

- pyscf 包能对任何分子结构计算精确的 FCI (基态 HF 波函数能量的精确解)
  - `fci = get_fci(x_init, atoms)`
- scipy.optimize 模块能寻找函数的最小值
  - `x_min = minimize(get_fci, args=(x_init, atoms)).x`
- 使用量子算法 `VQE` 去近似 `get_fci`，同样寻找最小值
- 比较两种方法能达到的最小能量，可衡量函数 `VQE` 和 `get_fci` 的逼近程度

问题难点：

- 待优化函数是一个量子算法 VQE
  - 其计算结果是近似而不准确的
  - 优化 vqe 的结果并不一定与真实 fci 接近，过拟合 vqe 可能导致 fci 分数反而低
- 优化器的选择
  - mindquantum 优化器不能用于 qupack
  - scipy 的优化器是局部优化，故初态结构选择很重要

解决方法：

- [x] 用 QuPack 复现 VQE-UCCSD
- [x] 探索位置初始化方法 (linear)
- [x] 探索优化器选择
  - 用比较快而粗的优化器 (COBYLA) 找到一个粗糙解
  - 再用比较慢而精的优化器 (trust-constr) 继续寻找
- [x] 达标的精度阈值 (1e-6)

----


### vqe_02

题目：给定一个分子结构，使用 VQE 算法的变种，求其第一激发态能量

目标：在要求的精度误差 <= 0.0016 范围内，运行时间越短越好

基本思路：求 `E = <psi|H|psi>`, 关键是制备 `|psi>` 使得 `E` 能迭代收敛

- 复现 正交VQE 和 子空间VQE，看看效果
- 研究瑞利商数公式，最大化它得到的 λmax 有什么用

解决方法：

- [x] 理解并复现 OC-VQE 和 SS-VQE
- [ ] 两阶段用不同的方法 (?)
- [x] 探索 ansatz 选择 (QUCC √)
- [x] 探索优化器选择 (trust-constr √)
- [x] 失败自动重试
- [x] 自适应扩大惩罚系数 β (损失函数不稳定)
- [x] 继续演化, 从 ansatz0 参数基础上 演化出 ansatz1

疑难杂症：

- 迭代式的 OC-VQE 的毛病
  - E0 近似精度达到 1e-2 ~ 1e-4 很容易，但 E1 误差可能非常大 (找到 E2/E3/.. 去了)
  - 如果 E0 被错误地被估计为 E1，则第二轮寻找 E1 容易失败
- wSS-VQE 的毛病
  - 只能搭配 HAE, E0 精度只有 1e-1
  - E1 误差非常大 (找到 E2/E3/.. 去了)
